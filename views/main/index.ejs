<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <%- include('../partials/head') %> <!-- 包含公共头部 -->
</head>
<body>
  <%- include('../partials/header') %>

  <!-- 动态分类导航 -->
  <div class="category-nav py-3 bg-white">
    <div class="container">
      <div class="d-flex flex-nowrap overflow-auto">
        <% categories.forEach(cat => { %>
          <a href="/category/<%= cat.catid %>" 
             class="btn btn-outline-secondary rounded-pill me-2">
            <%= cat.name %>
          </a>
        <% }); %>
      </div>
    </div>
  </div>

  <!-- 动态商品列表 -->
  <main class="container my-5">
    <h4 class="mb-4">精选商品</h4>
    <div class="product-grid">
      <% products.forEach(product => { %>
        <a href="/product/<%= product.pid %>" class="text-decoration-none">
          <div class="card">
            <% if (product.image) { %>
              <img src="/uploads/thumbnails/<%= product.image %>" 
                  class="product-img" 
                  alt="<%= product.name %>">
            <% } %>
            <div class="product-card-body">
              <h6 class="product-card-title"><%= product.name %></h6>
              <div class="d-flex justify-content-between align-items-center">
                <h5 class="product-card-price">¥<%= product.price.toFixed(2) %></h5>
                <button class="btn btn-sm btn-outline-primary add-to-cart" 
                        data-pid="<%= product.pid %>">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-cart-plus" viewBox="0 0 16 16">
                          <path d="M9 5.5a.5.5 0 0 0-1 0V7H6.5a.5.5 0 0 0 0 1H8v1.5a.5.5 0 0 0 1 0V8h1.5a.5.5 0 0 0 0-1H9z"/>
                          <path d="M.5 1a.5.5 0 0 0 0 1h1.11l.401 1.607 1.498 7.985A.5.5 0 0 0 4 12h1a2 2 0 1 0 0 4 2 2 0 0 0 0-4h7a2 2 0 1 0 0 4 2 2 0 0 0 0-4h1a.5.5 0 0 0 .491-.408l1.5-8A.5.5 0 0 0 14.5 3H2.89l-.405-1.621A.5.5 0 0 0 2 1zm3.915 10L3.102 4h10.796l-1.313 7h-8.17zM6 14a1 1 0 1 1-2 0 1 1 0 0 1 2 0m7 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/>
                        </svg>
                </button>
              </div>
            </div>
          </div>
        </a>
      <% }); %>
    </div>
  </main>

  <%- include('../partials/footer') %>
</body>
</html>