<!-- views/main/category.ejs -->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <%- include('../partials/head') %>
  <title><%= category.name %> - Sofire</title>
</head>
<body>
  <%- include('../partials/header') %>

  <!-- 分类标题 -->
  <nav aria-label="breadcrumb" class="bg-light py-3 border-bottom">
    <div class="container">
      <ol class="breadcrumb mb-0">
        <li class="breadcrumb-item"><a href="/">首页</a></li>
        <li class="breadcrumb-item active"><%= category.name %></li>
      </ol>
    </div>
  </nav>

  <!-- 分类商品列表 -->
  <main class="container my-5">
    <h4 class="mb-4"><%= category.name %> 商品</h4>
    <div class="product-grid">
      <% products.forEach(product => { %>
        <a href="/product/<%= product.pid %>" class="text-decoration-none">
          <div class="card">
            <% if (product.image) { %>
              <img src="/uploads/thumbnails/<%= product.image %>" 
                   class="product-img" 
                   alt="<%= product.name %>">
            <% } %>
            <div class="product-card-body">
              <h6 class="product-card-title"><%= product.name %></h6>
              <div class="d-flex justify-content-between align-items-center">
                <h5 class="product-card-price">¥<%= product.price.toFixed(2) %></h5>
                <button class="btn btn-sm btn-outline-primary add-to-cart"
                        data-pid="<%= product.pid %>">
                   <!-- 保留购物车图标 -->
                </button>
              </div>
            </div>
          </div>
        </a>
      <% }); %>
    </div>
  </main>

  <%- include('../partials/footer') %>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="/js/cart.js"></script>
</body>
</html>